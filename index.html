<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ø±ÙˆÛŒØ§</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Vazirmatn', sans-serif;
      direction: rtl;
      text-align: center;
      background: linear-gradient(to bottom right, #ffe0f0, #e0f7fa);
      padding: 20px;
    }

    h1 {
      color: #e91e63;
      font-size: 2.5rem;
    }

    .hidden {
      display: none;
    }

    .btn {
      background-color: #e91e63;
      color: white;
      border: none;
      padding: 12px 24px;
      font-size: 1rem;
      margin: 10px;
      cursor: pointer;
      border-radius: 10px;
      transition: background 0.3s;
    }

    .btn:hover {
      background-color: #d81b60;
    }

    .light-container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px 0;
    }

    .light {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      transition: box-shadow 0.3s;
      cursor: pointer;
      border: 3px solid #fff;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }

    #letterChoices button {
      font-size: 20px;
      margin: 6px;
      padding: 10px;
      border-radius: 8px;
      background-color: #fce4ec;
      color: #880e4f;
      font-weight: bold;
      border: none;
      cursor: pointer;
    }

    #selectedLetters {
      margin-top: 20px;
      font-size: 24px;
      font-weight: bold;
    }

    .gif {
      margin-top: 20px;
      width: 300px;
    }
  </style>
</head>
<body>
  <h1>ğŸ‰ ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ø±ÙˆÛŒØ§ ğŸ‰</h1>

  <!-- Ù…Ø±Ø­Ù„Ù‡ 1 -->
  <div id="step1">
    <h2>Ù†Ø§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†:</h2>
    <input type="text" id="nameInput" placeholder="Ù†Ø§Ù…..." />
    <br><br>
    <button class="btn" onclick="checkName()">Ø§Ø¯Ø§Ù…Ù‡</button>
  </div>

  <!-- Ù…Ø±Ø­Ù„Ù‡ 2: Ø¨Ø§Ø²ÛŒ Ú†Ø±Ø§Øºâ€ŒÙ‡Ø§ -->
  <div id="step2" class="hidden">
    <h2>ØªØ±ØªÛŒØ¨ Ø±ÙˆØ´Ù† Ø´Ø¯Ù† Ú†Ø±Ø§Øºâ€ŒÙ‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø®Ø§Ø·Ø± Ø¨Ø³Ù¾Ø§Ø± ğŸ’¡</h2>
    <div class="light-container" id="lights"></div>
    <div id="guessArea" class="hidden">
      <p>Ø­Ø§Ù„Ø§ Ø±ÙˆÛŒ Ú†Ø±Ø§Øºâ€ŒÙ‡Ø§ Ø¨Ù‡ ØªØ±ØªÛŒØ¨ Ú©Ù„ÛŒÚ© Ú©Ù†</p>
      <div class="light-container" id="guessLights"></div>
    </div>
  </div>

  <!-- Ù…Ø±Ø­Ù„Ù‡ 3: Ù…Ø¹Ù…Ø§ -->
  <div id="step3" class="hidden">
    <h2>Ú©Ø¯Ø§Ù… Ú©Ù„ÛŒØ¯ Ø§Ø³Øª Ú©Ù‡ Ù‡ÛŒÚ† Ø¯Ø±ÛŒ Ø±Ø§ Ø¨Ø§Ø² Ù†Ù…ÛŒâ€ŒÚ©Ù†Ø¯ØŸ ğŸ”</h2>
    <p>Ø¨Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ø­Ø±ÙˆÙ Ø¬ÙˆØ§Ø¨ Ø±Ø§ Ø¨Ø³Ø§Ø²:</p>
    <div id="letterChoices"></div>
    <div id="selectedLetters"></div>
    <button class="btn" onclick="checkRiddleAnswer()">Ø¨Ø±Ø±Ø³ÛŒ Ø¬ÙˆØ§Ø¨</button>
    <button class="btn" style="background:#f44336;" onclick="resetRiddle()">Ù¾Ø§Ú© Ú©Ù†</button>
    <img class="gif" src="https://media.gifdb.com/blue-haired-anime-girl-dancing-2zc3cgush44nid16.gif" />
  </div>

  <!-- Ù…Ø±Ø­Ù„Ù‡ 4: Ú¯ÛŒÙ ØªÙˆÙ„Ø¯ -->
  <div id="step4" class="hidden">
    <h2>ğŸ‚ ØªÙˆÙ„Ø¯Øª Ù…Ø¨Ø§Ø±Ú© Ø±ÙˆÛŒØ§ Ø¬Ø§Ù† ğŸ‚</h2>
    <p>Ø¨Ø§ Ø¢Ø±Ø²ÙˆÛŒ Ø¨Ù‡ØªØ±ÛŒÙ†â€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ ØªÙˆ ğŸŒ¸</p>
    <img class="gif" src="https://cliply.co/wp-content/uploads/2021/02/392102670_BIRTHDAY_CAKE_400px.gif" />
  </div>

  <script>
    const COLORS = ["yellow", "red", "blue", "green", "brown", "orange"];
    const LIGHT_COUNT = 6;
    const SEQUENCE_LENGTH = 6;
    let sequence = [], userGuess = [];

    const music1 = new Audio("Music1.mp3");
    const music2 = new Audio("Music2.mp3");
    music1.loop = true;
    music2.loop = true;

    function checkName() {
      const name = document.getElementById("nameInput").value.trim();
      if (name === "Ø±ÙˆÛŒØ§" || name.toLowerCase() === "roya") {
        document.getElementById("step1").classList.add("hidden");
        document.getElementById("step2").classList.remove("hidden");
        startLightGame();
        music1.play();
      } else {
        alert("ÙÙ‚Ø· Ø±ÙˆÛŒØ§ Ø§Ø¬Ø§Ø²Ù‡ ÙˆØ±ÙˆØ¯ Ø¯Ø§Ø±Ø¯!");
      }
    }

    function startLightGame() {
      const lightsContainer = document.getElementById("lights");
      const guessLightsContainer = document.getElementById("guessLights");
      const guessArea = document.getElementById("guessArea");
      lightsContainer.innerHTML = "";
      const lights = [];

      for (let i = 0; i < LIGHT_COUNT; i++) {
        const light = document.createElement("div");
        light.classList.add("light");
        light.style.backgroundColor = COLORS[i];
        lightsContainer.appendChild(light);
        lights.push(light);
      }

      sequence = [];
      let count = 0;
      const interval = setInterval(() => {
        const index = Math.floor(Math.random() * LIGHT_COUNT);
        sequence.push(index);
        lights[index].style.boxShadow = `0 0 20px 10px ${COLORS[index]}`;
        setTimeout(() => {
          lights[index].style.boxShadow = "none";
        }, 400);
        count++;
        if (count >= SEQUENCE_LENGTH) {
          clearInterval(interval);
          setTimeout(() => {
            guessArea.classList.remove("hidden");
            guessLightsContainer.innerHTML = "";
            userGuess = [];
            for (let i = 0; i < LIGHT_COUNT; i++) {
              const guessLight = document.createElement("div");
              guessLight.classList.add("light");
              guessLight.style.backgroundColor = COLORS[i];
              guessLight.dataset.index = i;
              guessLight.onclick = () => {
                userGuess.push(i);
                guessLight.style.boxShadow = `0 0 20px 10px ${COLORS[i]}`;
                setTimeout(() => {
                  guessLight.style.boxShadow = "none";
                }, 300);
                if (userGuess.length === SEQUENCE_LENGTH) checkLightAnswer();
              };
              guessLightsContainer.appendChild(guessLight);
            }
          }, 500);
        }
      }, 700);
    }

    function checkLightAnswer() {
      for (let i = 0; i < SEQUENCE_LENGTH; i++) {
        if (sequence[i] !== userGuess[i]) {
          alert("Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨ÙˆØ¯! Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†.");
          document.getElementById("guessArea").classList.add("hidden");
          startLightGame();
          return;
        }
      }
      alert("Ø¯Ø±Ø³Øª Ú¯ÙØªÛŒ! Ø¨Ø±ÛŒÙ… Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯.");
      document.getElementById("step2").classList.add("hidden");
      document.getElementById("step3").classList.remove("hidden");
    }

    // Ù…Ø¹Ù…Ø§
    let selected = [];

    function startRiddle() {
      const letters = "Ú© Ù„ ÛŒ Ø¯ Ø¨ Ø± Ù‚".split(" ");
      const extra = "Øª Ù† Ùˆ Ø¢ Øµ Ù Ú† Ø­".split(" ");
      const all = letters.concat(extra).sort(() => Math.random() - 0.5);
      const letterChoices = document.getElementById("letterChoices");
      const selectedLetters = document.getElementById("selectedLetters");

      selected = [];
      letterChoices.innerHTML = "";
      selectedLetters.textContent = "";

      all.forEach(char => {
        const btn = document.createElement("button");
        btn.textContent = char;
        btn.onclick = () => {
          selected.push(char);
          selectedLetters.textContent = selected.join("");
        };
        letterChoices.appendChild(btn);
      });
    }

    function resetRiddle() {
      selected = [];
      document.getElementById("selectedLetters").textContent = "";
    }

    function checkRiddleAnswer() {
      if (selected.join("") === "Ú©Ù„ÛŒØ¯Ø¨Ø±Ù‚" || selected.join("") === "Ú©Ù„ÙŠØ¯Ø¨Ø±Ù‚") {
        alert("Ø¢ÙØ±ÛŒÙ†! ğŸ‰");
        document.getElementById("step3").classList.add("hidden");
        document.getElementById("step4").classList.remove("hidden");
        music1.pause();
        music2.play();
      } else {
        alert("Ø¬ÙˆØ§Ø¨ Ù†Ø§Ø¯Ø±Ø³Øª Ø¨ÙˆØ¯. Ø¯ÙˆØ¨Ø§Ø±Ù‡ ØªÙ„Ø§Ø´ Ú©Ù†.");
        resetRiddle();
      }
    }

    // ÙØ±Ø§Ø®ÙˆØ§Ù† Ø§ÙˆÙ„ÛŒÙ‡
    startRiddle();
  </script>
</body>
</html>
